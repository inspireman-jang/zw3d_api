<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3장: 사용자 정의 메뉴</title>
    <style>
        body { 
            font-family: 'Malgun Gothic', Arial, sans-serif; 
            margin: 20px; 
            line-height: 1.8; 
            background-color: #fafafa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #2c5aa0; 
            border-bottom: 3px solid #2c5aa0; 
            padding-bottom: 10px;
            font-size: 2.2em;
        }
        h2 { 
            color: #4a7c59; 
            margin-top: 30px;
            font-size: 1.5em;
            border-left: 4px solid #4a7c59;
            padding-left: 15px;
        }
        h3 {
            color: #666;
            margin-top: 20px;
            font-size: 1.2em;
        }
        .code-block { 
            background-color: #f8f9fa; 
            padding: 20px; 
            border-radius: 6px; 
            font-family: 'Consolas', 'Monaco', monospace;
            border-left: 4px solid #007acc;
            margin: 15px 0;
            overflow-x: auto;
        }
        .note { 
            background-color: #fff3cd; 
            padding: 20px; 
            border-left: 5px solid #ffc107; 
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning {
            background-color: #f8d7da;
            padding: 20px;
            border-left: 5px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info {
            background-color: #d1ecf1;
            padding: 20px;
            border-left: 5px solid #17a2b8;
            margin: 20px 0;
            border-radius: 4px;
        }
        .section { 
            margin-bottom: 35px; 
            padding: 25px;
            background-color: #f8f9fa;
            border-radius: 6px;
        }
        .step-card {
            background-color: #fff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 6px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .step-number {
            background-color: #2c5aa0;
            color: white;
            padding: 5px 10px;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 10px;
        }
        .method-card {
            background-color: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #6c757d;
        }
        .file-structure {
            background-color: #f1f3f4;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
        }
        .language-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .language-table th, .language-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .language-table th {
            background-color: #f2f2f2;
        }
        ul, ol {
            padding-left: 25px;
        }
        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>3장: 사용자 정의 메뉴</h1>

        <div class="section">
            <p>ZW3D에서 첫 번째 사용자 정의 명령을 생성했지만, 입력 명령은 상대적으로 번거롭고, 대화형 버튼을 생성하는 것이 플러그인을 사용하는 데 더 편리할 것입니다. 이 장에서는 메뉴(메뉴, 리본 바, 툴바 등 포함)에 명령을 배치하는 방법을 보여드리겠습니다.</p>
            
            <p>ZW3D를 열면 위에서 아래로 <strong>빠른 액세스 툴바</strong>, <strong>메뉴</strong>, <strong>리본 바</strong>, <strong>툴바</strong>를 볼 수 있으며, 이들은 사용자 정의를 통해 편집할 수 있습니다.</p>
        </div>

        <div class="section">
            <h2>1. 페이지 관리 도구 열기</h2>
            <div class="step-card">
                <p>ZW3D를 열고, 리본 바의 빈 영역에서 마우스 오른쪽 버튼을 클릭한 후 <strong>사용자 정의...</strong>를 클릭합니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>2. 사용자 정의 명령</h2>
            
            <div class="step-card">
                <h3><span class="step-number">a</span>명령 속성 페이지 열기</h3>
                <p><strong>Commands</strong> 속성 페이지를 엽니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>유형을 All로 변경</h3>
                <p>유형을 <strong>All</strong>로 변경합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">c</span>새 명령 추가</h3>
                <p><strong>"+"</strong> 버튼을 클릭하여 새 명령을 추가합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">d</span>새 명령의 속성 수정</h3>
                <p>새 명령의 속성을 수정합니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>3. 자체 메뉴, 리본 바 및 툴바 생성</h2>
            
            <div class="step-card">
                <h3><span class="step-number">a</span>Transfer 속성 페이지로 전환</h3>
                <p><strong>Transfer</strong> 속성 페이지로 전환합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>유형을 All로 변경</h3>
                <p>유형을 <strong>All</strong>로 변경합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">c</span>환경을 Part로 변경</h3>
                <p>환경을 <strong>Part</strong>로 변경합니다 (이 경우 부품 환경을 추가할 수 있으며, 환경에 따라 설정할 수 있습니다).</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">d</span>zcui 파일 생성</h3>
                <p><strong>"+"</strong> 버튼을 클릭하여 zcui 파일을 생성합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">e</span>파일 이름 설정</h3>
                <p>파일 이름을 <strong>"HelloZW3DAPI"</strong>로 설정합니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>4. 새 zcui 파일 사용자 정의</h2>
            
            <div class="step-card">
                <h3><span class="step-number">a</span>새 옵션 생성</h3>
                <p>메뉴, 리본 바, 툴바에서 마우스 오른쪽 버튼을 클릭하여 새 옵션을 생성합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>명령 드래그</h3>
                <p>왼쪽에서 <strong>"Hello ZW3D API"</strong> 명령을 방금 생성한 옵션으로 드래그합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">c</span>인터페이스 레이아웃 생성</h3>
                <p>다음 그림과 같이 인터페이스 레이아웃을 생성합니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>5. 빠른 작업에 추가</h2>
            
            <div class="step-card">
                <h3><span class="step-number">a</span>유형을 All로 변경</h3>
                <p>유형을 <strong>All</strong>로 변경합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>환경을 Part로 변경</h3>
                <p>환경을 <strong>Part</strong>로 변경합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">c</span>명령 드래그</h3>
                <p>왼쪽에서 <strong>"Hello ZW3D API"</strong> 명령을 마우스 제스처 또는 단축키 툴바로 드래그합니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>6. OK를 클릭하여 사용자 정의 완료</h2>
            
            <div class="step-card">
                <h3><span class="step-number">a</span>부품 환경에서 버튼 찾기</h3>
                <p>부품 환경을 생성하면 메뉴, 리본 바, 툴바에서 추가한 버튼을 찾을 수 있으며, 버튼을 클릭하여 <strong>"~HelloZW3DAPI"</strong> 명령을 실행할 수 있습니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>마우스 제스처 사용</h3>
                <p><strong>"shift" + 마우스 오른쪽 버튼</strong> (설정에 따른 단축키)을 누르고 있으면 마우스 제스처가 호출되며, 이를 선택하여 실행할 수도 있습니다.</p>
            </div>

            <div class="warning">
                <p><strong>⚠️ 주의:</strong> "ALERT: Unable to find HelloZW3DAPI: No such symbol."라는 프롬프트가 표시되면, ZW3D에서 명령을 찾을 수 없다는 의미이므로 먼저 DLL을 로드해야 합니다. 자세한 내용은 2장, 5단계, DLL 로드를 참조하세요.</p>
            </div>
        </div>

        <div class="section">
            <h2>7. zcui 파일 배포</h2>
            
            <p>ZW3D2025 버전의 업그레이드 변경으로 인해, 구 버전의 zcui 파일은 구성 전에 업그레이드가 필요합니다. 자세한 내용은 8절을 참조하세요. 사용자 디렉토리의 빈번한 파일 변경으로 인해, 2025에서는 zcui 파일을 구성하기 위한 사용자 정의 경로를 등록하는 방법을 제공합니다. 이 방법을 사용하여 zcui 파일을 구성하는 것을 권장합니다. 사용자 정의 경로 방법 하에서 zcui 파일의 변경 및 업데이트를 유연하게 관리할 수 있습니다.</p>

            <div class="step-card">
                <h3><span class="step-number">a</span>사용자 폴더 경로에서 리소스 풀 zcui 파일 가져오기 (Actions.zcui)</h3>
                
                <p>이전 인터페이스를 통해 사용자 정의 명령을 추가한 후, ZW3D 사용자 파일 <strong>"%appdata%\ZWSOFT\ZW3D\ZW3D2025\custom\profiles\ResourcePool"</strong> 아래에서 "Actions"라는 이름의 zcui 파일을 찾을 수 있습니다.</p>

                <p>파일을 열면 사용자 정의 명령 텍스트가 "Action" 파일에 저장되고 있음을 볼 수 있습니다. 여기서 인덱스 값 <strong>"prefixKey"</strong>와 <strong>"name"</strong>이 함께 명령의 고유 위치를 완성하므로, 일반적으로 인덱스 값을 수정하지 마세요.</p>

                <div class="code-block">
                    <code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
&lt;Actions system="false"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ActionList prefixKey="{0f28791b-6d21-4df1-8ed1-f08881317595}"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Action name="ID_Action1" type="button"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Text&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Ribbon&gt;Hello ZW3D API&lt;/Ribbon&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Menu&gt;Hello ZW3D API&lt;/Menu&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Text&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Hint&gt;Hello ZW3D API&lt;/Hint&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Help&gt;&lt;/Help&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Desc&gt;Hello ZW3D API&lt;/Desc&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Script&gt;~HelloZW3DAPI&lt;/Script&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Action&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ActionList&gt;<br>
&lt;/Actions&gt;
                    </code>
                </div>

                <p>ZW3D 2025 이전 버전에서는 파일을 지정된 경로에 복사해야 효과가 있었습니다. 이제 사용자 정의 저장 경로를 지정할 수 있으며, 파일 관리의 편의성을 고려하여 사용자 정의 파일 경로를 사용하는 것을 권장합니다.</p>

                <p>파일을 <strong>"\Desktop\myzcui\"</strong> 디렉토리 아래에 저장하려면, 해당 경로 아래에 <strong>"\Desktop\myzcui\Settings\Default\"</strong>의 기본 파일 레벨을 생성해야 합니다. <strong>"Settings"</strong>와 <strong>"Default"</strong>는 필요한 식별 경로이며, <strong>"myzcui"</strong>는 사용자 정의 폴더입니다. 나중에 사용자 정의 경로를 등록하는 방법을 배우게 됩니다.</p>

                <p><strong>"Action"</strong> 파일은 <strong>"Default"</strong> 폴더에 저장되어야 하며, <strong>"ResourcePool"</strong>이라는 하위 폴더를 추가하여 저장해야 합니다. 이 폴더에 직접 저장된 zcui 파일은 ZW3D 시작 시 완전히 로드됩니다. 다국어 구성의 경우 로케일 폴더 생성을 생략할 수 있지만, 다국어 설정을 사용할 때는 반드시 해당 로케일 하위 폴더를 생성해야 합니다.</p>

                <p>다국어 환경에서 동일한 명령의 다른 텍스트를 사용자 정의해야 하는 경우, <strong>"ResourcePool"</strong> 폴더에 로케일용 새 하위 폴더를 생성해야 합니다. 지원되는 언어 표를 참조하여 필요한 언어 하위 디렉토리를 생성하고 해당 리소스 파일을 구성할 수 있습니다.</p>

                <table class="language-table">
                    <tr>
                        <th>지역</th>
                        <th>체코</th>
                        <th>독일</th>
                        <th>미국</th>
                        <th>스페인</th>
                        <th>프랑스</th>
                        <th>이탈리아</th>
                        <th>일본</th>
                        <th>한국</th>
                    </tr>
                    <tr>
                        <td>언어</td>
                        <td>cs_CZ</td>
                        <td>de_DE</td>
                        <td>en_US</td>
                        <td>es_ES</td>
                        <td>fr_FR</td>
                        <td>it_IT</td>
                        <td>ja_JP</td>
                        <td>ko_KR</td>
                    </tr>
                    <tr>
                        <th>지역</th>
                        <th>폴란드</th>
                        <th>브라질(포르투갈어)</th>
                        <th>러시아</th>
                        <th>터키</th>
                        <th>중국</th>
                        <th>대만, 중국</th>
                        <th></th>
                        <th></th>
                    </tr>
                    <tr>
                        <td>언어</td>
                        <td>pl_PL</td>
                        <td>pt_PT</td>
                        <td>ru_RU</td>
                        <td>tr_TR</td>
                        <td>zh_CN</td>
                        <td>zh_TW</td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>

                <div class="note">
                    <p><strong>📝 중요:</strong> 공통 구성과 <strong>"ResourcePool"</strong>에 직접 배치된 다국어 구성은 동일한 인덱스 값 <strong>"prefixKey"</strong>와 <strong>"name"</strong>을 가질 수 없습니다. 그렇지 않으면 설정이 무효가 될 수 있습니다. 따라서 여러 언어를 구성해야 할 때는 <strong>"ResourcePool"</strong>에 파일을 직접 배치하지 않는 것을 권장하며, 로케일 수에 따라 여러 구성 파일을 복사하여 해당 하위 폴더에 배치할 수 있습니다.</p>
                </div>

                <p>여러 언어 폴더 아래의 파일들은 현재 실행된 ZW3D 로케일과 함께만 로드되며, 그들 사이에는 정확히 동일한 인덱스 값 <strong>"prefixKey"</strong>와 <strong>"name"</strong>이 있을 수 있습니다. 수정해야 할 유일한 것은 그림에 표시된 텍스트 부분입니다. 수정된 <strong>"Action.zcui"</strong> 파일을 해당 하위 언어 디렉토리에 배치하여 리소스 파일 배치를 완료합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>사용자 폴더 경로에서 사용자 정의 정책용 zcui 파일 가져오기 (HelloZW3DAPI.zcui)</h3>
                
                <p>위에서 설정한 부품 환경의 사용자 정의 메뉴를 사용하여, 해당 경로 <strong>"%appdata%\ZWSOFT\ZW3D\ZW3D2025\custom\profiles\4-Expert\Environment-10-Part"</strong> 아래에서 <strong>"HelloZW3DAPI"</strong>라는 이름의 zcui 파일을 찾아야 합니다.</p>

                <p>사용자 정의 옵션이 환경과 일대일로 대응하는 폴더이므로, 파일이 다른 환경에서 설정된 경우 해당 경로로 이동해야 합니다. <strong>"Environment-2-Z3"</strong>는 다중 루트 파일 환경의 <strong>"Part/Assembly"</strong> 항목에 대응되며, 단일 루트 부품과 어셈블리 환경 모두에 동시에 적응하는 것이 아님을 주의해야 합니다.</p>

                <p>파일을 열면 <strong>"HelloZW3DAPI.zcui"</strong>가 각각 <strong>"10-part"</strong>와 <strong>"4-expert"</strong>의 환경과 역할에 적응되어 있음을 볼 수 있습니다. 구성은 플랫폼의 해당 환경과 역할에서만 효과가 있습니다. 예를 들어, <strong>"10-Part"</strong>와 <strong>"4-Expert"</strong> 아래의 구성은 <strong>"10-Part"</strong> 이외의 환경이나 <strong>"4-Expert"</strong> 이외의 역할을 선택할 때 효과가 없습니다.</p>

                <p>앞서 생성한 <strong>"...\Desktop\myzcui\Settings\Default\"</strong> 디렉토리에 <strong>"Strategy"</strong> 폴더를 추가합니다.</p>

                <p>네이티브 zcui 정책이 환경의 하위 폴더에 저장되고 폴더가 zcui 파일의 식별에 관여하므로, 폴더를 생성해야 합니다 (이 폴더 계층을 정의하지 않으면 zcui 파일을 찾을 수 없습니다). 물론 이 폴더의 이름은 사용자 정의를 지원합니다. 하위 폴더의 <strong>"UserName"</strong>을 사용자 정의할 수 있습니다.</p>

                <p>수정된 <strong>"HelloZW3DAPI.zcui"</strong> 파일을 사용자 정의 폴더에 배치하여 파일 배치를 완료합니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">c</span>사용자 폴더 경로에서 기본 정책 zcui 파일 가져오기 (LayoutStrategy.zcui)</h3>
                
                <p>기본 사용자 차별화 정책 파일은 <strong>"LayoutStrategy.zcui"</strong>라는 이름이며, 핫키와 빠른 작업에 대한 수정 및 구성이 이 파일에 작성됩니다. 물론 이 기본 파일에서 메뉴 구성을 수정할 수도 있지만, 이 파일의 고유성으로 인해 이 파일에서 직접 메뉴를 구성하는 것은 권장하지 않습니다. 필요한 핫키와 단축 제스처가 있는 경우 설정을 수정하고 저장할 수 있습니다.</p>

                <p>해당 경로 <strong>"%appdata%\ZWSOFT\ZW3D\ZW3D2025\custom\profiles\4-Expert\Environment-10-Part"</strong>에서 LayoutStrategy라는 이름의 zcui 기본 정책 파일을 찾을 수 있습니다.</p>

                <p>그런 다음 파일을 사용자 정의 폴더 <strong>"...\Desktop\myzcui\Settings\Default\Strategy\UserName"</strong>에 복사하여 앞서 복사한 <strong>"HelloZW3DAPI.zcui"</strong> 파일과 함께 배치할 수 있습니다. zcui 파일의 효과가 덮어쓰기되므로, 여러 파일에서 동일한 작업을 다르게 구성할 때 나중에 로드된 파일의 구성이 이전 로드의 효과를 덮어쓰므로 사용자 정의 구성의 고유성에 주의하세요.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">d</span>등록 파일 경로</h3>
                
                <p>이전 글에서 <strong>"...\Desktop\myzcui\Settings\Default\"</strong>의 기본 디렉토리를 생성했습니다. 여기서 <strong>"Settings"</strong>와 <strong>"Default"</strong>는 필요한 식별 경로이며, <strong>"myzcui"</strong>는 사용자 정의 폴더를 의미합니다. 이 디렉토리에 리소스 파일과 전략 파일을 배치하기 위해 <strong>"ResourcePool"</strong>과 <strong>"Strategy"</strong> 하위 폴더를 추가했습니다.</p>

                <p>그 후 플러그인의 초기화 과정에서 검색 경로를 등록하여 리소스를 자동으로 로드해야 합니다. 먼저 <strong>"ZwResourcePathAdd"</strong> 작업을 호출하여 파일 검색 경로 <strong>"...\Desktop\myzcui\"</strong>를 등록해야 합니다. 디렉토리 경로는 <strong>"Settings\Default"</strong>의 상위 레벨, 즉 <strong>"myzcui"</strong>를 가리켜야 하며, 그렇지 않으면 검색되지 않습니다.</p>

                <p>그런 다음 <strong>"ZwProfileModuleNameRegister"</strong> 작업을 호출하여 경로에 경로 이름을 등록합니다 (예: <strong>"myzcui"</strong>). zcui 파일 경로가 등록된 후, ZW3D 시작 시 경로의 zcui 파일이 완전히 로드됩니다. zcui 파일이 로드되지 않으면 경로 등록이 플러그인 초기화와 관련된 인터페이스에 배치되지 않았는지 확인하세요.</p>

                <div class="code-block">
                    <code>
int HelloZW3DInit()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;int nBytes = sizeof(zwString512);<br>
&nbsp;&nbsp;&nbsp;&nbsp;zwString512 path{};<br>
&nbsp;&nbsp;&nbsp;&nbsp;ZwPathSeparatorCheck("C:\\Users\\Administrator\\Desktop\\myzcui", nBytes, path);<br>
&nbsp;&nbsp;&nbsp;&nbsp;ZwResourcePathAdd(path);<br>
&nbsp;&nbsp;&nbsp;&nbsp;ZwProfileModuleNameRegister("myzcui");<br>
&nbsp;&nbsp;&nbsp;&nbsp;RegisterCustomCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;RegisterTemplateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;RegisterFormCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br>
}
                    </code>
                </div>

                <p><strong>"...\Desktop\myzcui\Settings\Default\icons\HelloZW3D.png"</strong>를 아이콘 파일로 로드하려는 경우 (사용자 정의 아이콘 유형은 png 형식만 지원), 이미지가 위치한 폴더의 전체 경로를 등록하기 위해 <strong>"ZwResourcePathAdd"</strong>를 호출해야 합니다 (예: <strong>"...\myzcui\Settings\Default"</strong>).</p>

                <p>물론 중복 경로 등록을 피하기 위해 <strong>"Settings"</strong>와 같은 레벨에 <strong>"icons"</strong> 폴더를 생성할 수도 있습니다.</p>

                <div class="warning">
                    <p><strong>⚠️ 주의:</strong> DLL 파일의 초기 로드 후 해당 리소스가 업데이트되어야 하므로, DLL을 직접 로드한 후 바로 zcui 구성이 효과를 보는 것을 볼 수 없습니다. ZW3D를 다시 시작하거나 사용자를 전환하여 리소스 업데이트를 완료해야 합니다. 리소스의 동기화를 보장하기 위해 구성 완료 후 ZW3D를 다시 시작하는 것을 권장합니다.</p>
                </div>

                <p>2장 5절의 방법에 따라 dll을 직접 로드하거나 ZW3D 사용자 디렉토리에 배치할 수도 있습니다.</p>
                <div class="code-block">
                    <code>"%appdata%\ZWSOFT\ZW3D\ZW3D2025\custom\apilibs"</code>
                </div>
                <p>사용자 디렉토리의 리소스 파일이 자동으로 로드됩니다.</p>
            </div>
        </div>

        <div class="section">
            <h2>8. zcui 파일 업그레이드</h2>
            
            <p>ZW3D의 이전 버전에서 기존 zcui 파일을 2025 버전으로 마이그레이션하거나 재사용하려는 경우, 구성 및 사용하기 전에 업그레이드해야 합니다. 편의를 위해 설치 디렉토리에 사용하기 쉬운 zcui 파일 업그레이드 도구 <strong>"ZcuiUpdater"</strong>를 제공하여 이전 버전의 zcui 파일을 업그레이드하는 데 도움을 줍니다.</p>

            <div class="step-card">
                <h3><span class="step-number">a</span>업그레이드할 파일 경로 추가</h3>
                <p>업그레이드하려는 파일이 위치한 경로를 추가하면, 위젯이 경로 아래에서 업그레이드가 필요한 저버전 zcui 파일을 자동으로 로드합니다. Clear를 클릭하여 현재 선택을 지우고 다시 선택할 수 있습니다.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">b</span>업그레이드된 파일의 출력 경로 선택</h3>
                <p>업그레이드된 파일의 출력 경로를 선택하고 Upgrade를 클릭합니다. 업그레이드가 성공했다는 녹색 텍스트가 표시되면 파일 업그레이드가 성공한 것입니다. 업그레이드를 취소하려면 아래의 Clear Output을 클릭하세요.</p>
                
                <div class="success">
                    <p><strong>업그레이드 결과:</strong></p>
                    <p>Upgrade action file successfully. Upgrade widget file successfully.<br>
                    Upgrade successfully.</p>
                </div>
            </div>

            <div class="step-card">
                <h3><span class="step-number">c</span>업그레이드 완료 후 파일 배치</h3>
                <p>업그레이드가 완료된 후, 지정한 출력 디렉토리에서 ResourcePool과 Strategy 폴더를 볼 수 있습니다. 위에서 설명한 대로 지정된 폴더에 배치하기만 하면 됩니다.</p>
            </div>

            <div class="warning">
                <p><strong>⚠️ 주의:</strong> 이전 버전에서 생성된 zcui 파일과 2025 버전에서 생성된 zcui 파일 사이에는 몇 가지 차이점이 있습니다. 예를 들어, 2025 버전에서 생성된 zcui에는 인덱스 값 <strong>"prefixKey"</strong>가 존재하지만, 이전 버전에서 생성된 zcui 파일에는 이 필드가 포함되어 있지 않습니다.</p>
                
                <p>따라서 동일한 이름의 명령 효과가 덮어쓰기되는 것을 방지하기 위해 사용자 정의 명령의 이름을 수정하는 것을 권장합니다. 2025 버전에서는 zcui 파일을 사용자 디렉토리의 프로필 폴더에 직접 복사하는 것을 권장하지 않으며, 이는 zcui 파일 관리에 도움이 되지 않습니다.</p>
                
                <p>사용자 디렉토리에 배치하는 방법을 계속 사용하려는 경우, 특히 이전 버전에서 업그레이드된 zcui 파일을 재사용할 때는 텍스트의 <strong>"DefaultCustomizations"</strong>를 <strong>"UserCustomizations"</strong>로 변경하고, 해당 <strong>"name"</strong>을 반복되지 않을 다른 이름으로 변경해야 합니다.</p>
                
                <p>특별한 경우에는 zcui 파일을 ZW3D 설치 디렉토리의 Settings 폴더로 마이그레이션하여 사용자 정의 zcui 파일을 기본 시작 항목으로 처리할 수 있습니다. 보안 및 제어 관점에서 두 가지 직접 복제 방법을 모두 사용하는 것은 권장하지 않습니다.</p>
            </div>
        </div>
    </div>
</body>
</html>
